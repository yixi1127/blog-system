# åšå®¢ç³»ç»Ÿåç«¯éƒ¨ç½²å®Œæ•´æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [å‡†å¤‡å·¥ä½œ](#å‡†å¤‡å·¥ä½œ)
2. [åˆ›å»º Supabase æ•°æ®åº“](#åˆ›å»º-supabase-æ•°æ®åº“)
3. [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
4. [é…ç½®ç¯å¢ƒå˜é‡](#é…ç½®ç¯å¢ƒå˜é‡)
5. [éƒ¨ç½²åˆ° Netlify](#éƒ¨ç½²åˆ°-netlify)
6. [æµ‹è¯• API](#æµ‹è¯•-api)
7. [ä¿®æ”¹å‰ç«¯ä»£ç ](#ä¿®æ”¹å‰ç«¯ä»£ç )

---

## 1ï¸âƒ£ å‡†å¤‡å·¥ä½œ

### ä½ éœ€è¦ï¼š
- âœ… GitHub è´¦å·
- âœ… Netlify è´¦å·ï¼ˆä½ å·²ç»æœ‰äº†ï¼‰
- âœ… Supabase è´¦å·ï¼ˆå…è´¹æ³¨å†Œï¼‰

---

## 2ï¸âƒ£ åˆ›å»º Supabase æ•°æ®åº“

### æ­¥éª¤ 1ï¼šæ³¨å†Œ Supabase
1. æ‰“å¼€ https://supabase.com/
2. ç‚¹å‡» "Start your project"
3. ç”¨ GitHub ç™»å½•
4. ç‚¹å‡» "New Project"

### æ­¥éª¤ 2ï¼šåˆ›å»ºé¡¹ç›®
- **Organization**: é€‰æ‹©ä½ çš„ç»„ç»‡ï¼ˆæˆ–åˆ›å»ºæ–°çš„ï¼‰
- **Project name**: `blog-system`ï¼ˆéšä¾¿èµ·åï¼‰
- **Database Password**: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç ï¼ˆè®°ä½å®ƒï¼ï¼‰
- **Region**: é€‰æ‹© `Northeast Asia (Tokyo)` æˆ– `Southeast Asia (Singapore)`
- ç‚¹å‡» "Create new project"ï¼Œç­‰å¾… 1-2 åˆ†é’Ÿ

### æ­¥éª¤ 3ï¼šåˆ›å»ºæ•°æ®åº“è¡¨
1. åœ¨ Supabase æ§åˆ¶å°ï¼Œç‚¹å‡»å·¦ä¾§ **SQL Editor**
2. ç‚¹å‡» **New query**
3. å¤åˆ¶ `database-setup.sql` æ–‡ä»¶çš„å†…å®¹
4. ç²˜è´´åˆ°ç¼–è¾‘å™¨ï¼Œç‚¹å‡» **Run**
5. çœ‹åˆ° "Success" å°±æˆåŠŸäº†ï¼

### æ­¥éª¤ 4ï¼šè·å– API å¯†é’¥
1. ç‚¹å‡»å·¦ä¾§ **Settings** (é½¿è½®å›¾æ ‡)
2. ç‚¹å‡» **API**
3. æ‰¾åˆ°å¹¶å¤åˆ¶ï¼š
   - **Project URL** (ç±»ä¼¼: `https://xxxxx.supabase.co`)
   - **anon public** key (å¾ˆé•¿çš„ä¸€ä¸²å­—ç¬¦)
4. ä¿å­˜è¿™ä¸¤ä¸ªå€¼ï¼Œåé¢è¦ç”¨ï¼

---

## 3ï¸âƒ£ å®‰è£…ä¾èµ–

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```bash
npm install @supabase/supabase-js bcryptjs jsonwebtoken
```

è¿™ä¼šå®‰è£…ï¼š
- `@supabase/supabase-js`: Supabase å®¢æˆ·ç«¯
- `bcryptjs`: å¯†ç åŠ å¯†
- `jsonwebtoken`: ç”Ÿæˆç™»å½• token

---

## 4ï¸âƒ£ é…ç½®ç¯å¢ƒå˜é‡

### åœ¨ Netlify ç½‘ç«™é…ç½®ï¼š

1. ç™»å½• Netlify: https://app.netlify.com/
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. ç‚¹å‡» **Site settings**
4. ç‚¹å‡»å·¦ä¾§ **Environment variables**
5. ç‚¹å‡» **Add a variable**

æ·»åŠ ä»¥ä¸‹ 3 ä¸ªå˜é‡ï¼š

| Key | Value | è¯´æ˜ |
|-----|-------|------|
| `SUPABASE_URL` | `https://xxxxx.supabase.co` | ä½ çš„ Supabase URL |
| `SUPABASE_KEY` | `eyJhbGc...å¾ˆé•¿çš„å­—ç¬¦ä¸²` | ä½ çš„ Supabase anon key |
| `JWT_SECRET` | `éšæœºå­—ç¬¦ä¸²` | ç”¨äºç”Ÿæˆ tokenï¼Œéšä¾¿è¾“å…¥ä¸€ä¸²å¤æ‚å­—ç¬¦ |

**JWT_SECRET ç¤ºä¾‹**ï¼š`my-super-secret-key-2024-blog-system-xyz123`

---

## 5ï¸âƒ£ éƒ¨ç½²åˆ° Netlify

### æ–¹æ³• 1ï¼šé€šè¿‡ Git è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. æŠŠä»£ç æ¨é€åˆ° GitHubï¼š
```bash
git add .
git commit -m "æ·»åŠ åç«¯ API"
git push
```

2. Netlify ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ›´æ–°å¹¶é‡æ–°éƒ¨ç½²
3. ç­‰å¾… 2-3 åˆ†é’Ÿï¼Œéƒ¨ç½²å®Œæˆï¼

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨éƒ¨ç½²

1. åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š
```bash
npm run build
```

2. åœ¨ Netlify ç½‘ç«™ï¼Œç‚¹å‡» **Deploys** â†’ **Drag and drop**
3. æŠŠ `dist` æ–‡ä»¶å¤¹æ‹–è¿›å»

---

## 6ï¸âƒ£ æµ‹è¯• API

éƒ¨ç½²å®Œæˆåï¼Œä½ çš„ API åœ°å€æ˜¯ï¼š
```
https://ä½ çš„ç½‘ç«™.netlify.app/.netlify/functions/å‡½æ•°å
```

### æµ‹è¯•æ³¨å†Œ API

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œè¿è¡Œï¼š

```javascript
fetch('https://ä½ çš„ç½‘ç«™.netlify.app/.netlify/functions/auth-register', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    username: 'testuser',
    email: 'test@example.com',
    password: '123456'
  })
})
.then(res => res.json())
.then(data => console.log(data));
```

å¦‚æœè¿”å› `{ success: true, user: {...} }`ï¼Œè¯´æ˜æˆåŠŸäº†ï¼

### æµ‹è¯•ç™»å½• API

```javascript
fetch('https://ä½ çš„ç½‘ç«™.netlify.app/.netlify/functions/auth-login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    username: 'testuser',
    password: '123456'
  })
})
.then(res => res.json())
.then(data => console.log(data));
```

åº”è¯¥è¿”å› `{ success: true, token: "...", user: {...} }`

---

## 7ï¸âƒ£ ä¿®æ”¹å‰ç«¯ä»£ç 

ç°åœ¨éœ€è¦æŠŠå‰ç«¯çš„ localStorage æ”¹æˆè°ƒç”¨çœŸå® APIã€‚

### ä¿®æ”¹ `src/views/RegisterView.vue`

æ‰¾åˆ° `handleRegister` å‡½æ•°ï¼Œæ”¹æˆï¼š

```javascript
const handleRegister = async () => {
  loading.value = true;
  try {
    const response = await fetch('/.netlify/functions/auth-register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: formState.username,
        email: formState.email,
        password: formState.password
      })
    });

    const data = await response.json();

    if (response.ok && data.success) {
      message.success('æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•');
      router.push('/user/login');
    } else {
      message.error(data.error || 'æ³¨å†Œå¤±è´¥');
    }
  } catch (error) {
    message.error('æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
  } finally {
    loading.value = false;
  }
};
```

### ä¿®æ”¹ `src/views/LoginView.vue`

æ‰¾åˆ° `handleLogin` å‡½æ•°ï¼Œæ”¹æˆï¼š

```javascript
const handleLogin = async () => {
  loading.value = true;
  try {
    const response = await fetch('/.netlify/functions/auth-login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: formState.username,
        password: formState.password
      })
    });

    const data = await response.json();

    if (response.ok && data.success) {
      message.success('ç™»å½•æˆåŠŸ');
      // ä¿å­˜ token å’Œç”¨æˆ·ä¿¡æ¯
      localStorage.setItem('token', data.token);
      localStorage.setItem('userInfo', JSON.stringify(data.user));
      router.push('/');
    } else {
      message.error(data.error || 'ç™»å½•å¤±è´¥');
    }
  } catch (error) {
    message.error('ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
  } finally {
    loading.value = false;
  }
};
```

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„ç³»ç»Ÿæœ‰äº†çœŸå®çš„åç«¯ï¼š
- âœ… ç”¨æˆ·å¯ä»¥çœŸå®æ³¨å†Œ
- âœ… ç”¨æˆ·å¯ä»¥çœŸå®ç™»å½•
- âœ… æ•°æ®ä¿å­˜åœ¨äº‘ç«¯æ•°æ®åº“
- âœ… ä¸åŒè®¾å¤‡å¯ä»¥å…±äº«æ•°æ®

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²å API è¿”å› 404ï¼Ÿ
**A**: æ£€æŸ¥ `netlify.toml` æ–‡ä»¶æ˜¯å¦åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶ä¸”å·²ç»æ¨é€åˆ° GitHubã€‚

### Q2: API è¿”å› 500 é”™è¯¯ï¼Ÿ
**A**: æ£€æŸ¥ Netlify ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®ï¼Œç‰¹åˆ«æ˜¯ `SUPABASE_URL` å’Œ `SUPABASE_KEY`ã€‚

### Q3: å¦‚ä½•æŸ¥çœ‹åç«¯æ—¥å¿—ï¼Ÿ
**A**: åœ¨ Netlify ç½‘ç«™ï¼Œç‚¹å‡» **Functions** â†’ é€‰æ‹©å‡½æ•° â†’ æŸ¥çœ‹ **Function log**ã€‚

### Q4: å¯†ç å¿˜è®°äº†æ€ä¹ˆåŠï¼Ÿ
**A**: ç›®å‰è¿˜æ²¡æœ‰æ‰¾å›å¯†ç åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥åœ¨ Supabase æ§åˆ¶å°çš„ **Table Editor** ä¸­ä¿®æ”¹ç”¨æˆ·å¯†ç ã€‚

---

## ğŸ“š ä¸‹ä¸€æ­¥

ç°åœ¨ä½ å·²ç»å®Œæˆäº†æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ï¼æ¥ä¸‹æ¥å¯ä»¥ï¼š

1. **æ·»åŠ æ–‡ç« ç®¡ç† API**ï¼ˆåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æ–‡ç« ï¼‰
2. **æ·»åŠ åˆ†ç±»ç®¡ç† API**
3. **æ·»åŠ ç”¨æˆ·ä¸ªäººèµ„æ–™ä¿®æ”¹åŠŸèƒ½**
4. **æ·»åŠ æ‰¾å›å¯†ç åŠŸèƒ½**

éœ€è¦æˆ‘ç»§ç»­å¸®ä½ å®ç°è¿™äº›åŠŸèƒ½å—ï¼Ÿå‘Šè¯‰æˆ‘ä½ æƒ³å…ˆåšå“ªä¸ªï¼
